#!/usr/bin/env bash

# function fetch {
#     url="$1"
#     echo "$url"
#     if curl -s -I "$url" | grep "200 OK"; then
#         chromium --new-window "$url";
#         exit;
#     #     echo "open chromium"
#     #     return 0;
#     # else
#     #     echo "dont open chromium"
#     #     return 1;
#     fi
# }

function fetch {
    URL="$1"
    echo "$URL"
    if curl --fail --head --silent --output /dev/null "$URL"; then
        evince "$URL" --page-index="$(date +%u)";
        exit 0
    fi
}

# false ||
#     fetch "https://torvekoekken.dk/img/cms/menuer/Favorit%20uge%20$(date +%-V).pdf" ||
#     fetch "https://torvekoekken.dk/img/cms/Favorit%20uge%20$(date +%-V).pdf"

# fetch "https://torvekoekken.dk/img/cms/menuer/Favorit%20uge%20$(date +%-V).pdf"
# fetch "https://torvekoekken.dk/img/cms/Favorit%20uge%20$(date +%-V).pdf"
# fetch "https://torvekoekken.dk/Files/Images/Til%20ugens%20menu/Menuer%20Favorit/Favorit%20uge%20$(date +%-V).pdf"

WEEK="$(date +%V)"
WEEK_NP="$(date +%-V)"
# fetch "https://torvekoekken.dk/Files/Images/Til%20ugens%20menu/Menuer%20Favorit/Favorit%20uge%20${WEEK_NP}.pdf"
# fetch "https://torvekoekken.dk/Files/Images/Til%20ugens%20menu/Menuer%20Favorit/Favorit%20uge%20${WEEK_NP}%202019.pdf"
# fetch "https://torvekoekken.dk/Files/Images/Til%20ugens%20menu/Menuer%20Favorit/Favorit%20uge%20${WEEK}%202019.pdf"
fetch "https://torvekoekken.dk/Files/Images/Til%20ugens%20menu/Menuer%20Favorit/Favorit%20menu%20uge%20${WEEK}%202019.pdf"
fetch "https://torvekoekken.dk/Files/Images/Til%20ugens%20menu/Menuer%20Favorit/Favorit%20menu%20uge%20${WEEK}_2019__.pdf"
fetch "https://torvekoekken.dk/Files/Images/Til%20ugens%20menu/Menuer%20Favorit/Favorit%20menu%20uge%20${WEEK}_2019.pdf"
# curl --fail --head --silent --output /dev/null "$URL"
# evince "$URL" --page-index="$(date +%u)"
